########### Cek SSTI
${{<%[%'"}}%\.

########### https://portswigger.net/web-security/server-side-template-injection/exploiting/lab-server-side-template-injection-basic 

Notice that when you try to view more details about the first product, a GET request uses the message parameter 
to render "Unfortunately this product is out of stock" on the home page.

In the ERB documentation, discover that the syntax <%= someExpression %> is used to evaluate 
an expression and render the result on the page.

Use ERB template syntax to create a test payload containing a mathematical operation, for example:
<%= 7*7 %>

########### https://portswigger.net/web-security/server-side-template-injection/exploiting/lab-server-side-template-injection-basic-code-context

While proxying traffic through Burp, log in and post a comment on one of the blog posts.

Notice that on the "My account" page, you can select whether you want the site to use your full name, first name, or nickname. 
When you submit your choice, a POST request sets the value of the parameter blog-post-author-display to either user.name, user.first_name, or user.nickname. 
When you load the page containing your comment, the name above your comment is updated based on the current value of this parameter.

In Burp, go to "Proxy" > "HTTP history" and find the request that sets this parameter, namely POST /my-account/change-blog-post-author-display, 
and send it to Burp Repeater.

Study the Tornado documentation to discover that template expressions are surrounded with double curly braces, such as {{someExpression}}. 
In Burp Repeater, notice that you can escape out of the expression and inject arbitrary template syntax as follows:
blog-post-author-display=user.name}}{{7*7}}

Reload the page containing your test comment. Notice that the username now says Peter Wiener49}}, 
indicating that a server-side template injection vulnerability may exist in the code context. 

########### https://portswigger.net/web-security/server-side-template-injection/exploiting/lab-server-side-template-injection-using-documentation

1. https://i.imgur.com/lcbWUVb.png
2. https://i.imgur.com/fcsE6cW.png
3. https://i.imgur.com/SQdjBuV.png

########### https://portswigger.net/web-security/server-side-template-injection/exploiting/lab-server-side-template-injection-in-an-unknown-language-with-a-documented-exploit

Notice that when you try to view more details about the first product, a GET request uses the message parameter to render 
"Unfortunately this product is out of stock" on the home page.

Experiment by injecting a fuzz string containing template syntax from various different template languages, 
such as ${{<%[%'"}}%\, into the message parameter. Notice that when you submit invalid syntax, an error message is shown in the output. 
This identifies that the website is using Handlebars.

Search the web for "Handlebars server-side template injection". You should find a well-known exploit posted by @Zombiehelp54.

Modify this exploit so that it calls require("child_process").exec("rm /home/carlos/morale.txt") as follows: 

########### https://portswigger.net/web-security/server-side-template-injection/exploiting/lab-server-side-template-injection-with-information-disclosure-via-user-supplied-objects

Log in and edit one of the product description templates.

Change one of the template expressions to something invalid, such as a fuzz string ${{<%[%'"}}%\, and save the template. 
The error message in the output hints that the Django framework is being used.

Study the Django documentation and notice that the built-in template tag debug can be called to display debugging information.

In the template, remove your invalid syntax and enter the following statement to invoke the debug built-in:
{% debug %}

########### https://portswigger.net/web-security/server-side-template-injection/exploiting/lab-server-side-template-injection-in-a-sandboxed-environment

https://youtu.be/Kr4Vup8W3-8

########### https://portswigger.net/web-security/server-side-template-injection/exploiting/lab-server-side-template-injection-with-a-custom-exploit

https://youtu.be/atTJS1Ra218
